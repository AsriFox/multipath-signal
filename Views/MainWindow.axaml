<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:MultipathSignal.Views"
        x:Class="MultipathSignal.Views.MainWindow"
        Title="Multipath signal - delayed reception"
        Width="688" Height="800" MinWidth="420" MinHeight="420">
  <Design.DataContext>
    <local:MainWindowViewModel />
  </Design.DataContext>
  
  <Window.Styles>
    <StyleInclude Source="/Views/NumberBox.axaml" />
    <Style Selector="Button, ToggleButton">
      <Setter Property="HorizontalAlignment" Value="Stretch" />
      <Setter Property="Margin" Value="2" />
    </Style>
    <Style Selector="local|NumberBox">
      <Setter Property="HorizontalAlignment" Value="Stretch" />
      <Setter Property="Margin" Value="0,8,0,0" />
      <Setter Property="IsEnabled" Value="{Binding EditMode}" />
    </Style>
    <Style Selector="Expander">
      <Setter Property="Padding" Value="0" />
      <Setter Property="MinWidth" Value="210" />
    </Style>
    <Style Selector="Expander > TextBlock">
      <Setter Property="Foreground" Value="{StaticResource ThemeForegroundBrush}" />
      <Setter Property="Margin" Value="0,-2" />
    </Style>
  </Window.Styles>
  
  <DockPanel>
    <Grid Name="StatusBar" 
          ColumnDefinitions="0.5*, 0.5*, 2*" 
          DockPanel.Dock="Bottom">
      
      <TextBlock Text="Predicted delay:"
                 VerticalAlignment="Center"
                 TextWrapping="Wrap"
                 Grid.Column="0"
                 Margin="4" />
      <TextBox Text="{Binding PredictedDelay, Mode=OneWay}"
               VerticalContentAlignment="Center"
               BorderBrush="Transparent"
               IsReadOnly="True"
               Grid.Column="1"
               FontSize="12"
               Margin="2"/>
      <TextBlock Text="{Binding Status, Mode=OneWay}"
                 VerticalAlignment="Center"
                 Grid.Column="2" 
                 Margin="4,0" />
    </Grid>
    
    <UniformGrid Name="ActionButtons" 
                 DockPanel.Dock="Bottom" 
                 Rows="1">
      
      <Button Content="Generate" 
              Command="{Binding ProcessSignal}" 
              IsEnabled="{Binding EditMode}" 
              PointerEnter="PointerMoveFocus" />
      
      <Button Content="Repeat tests"
              Command="{Binding ProcessRepeat}" 
              IsEnabled="{Binding EditMode}" 
              PointerEnter="PointerMoveFocus" />
      
      <ToggleButton Name="ToggleShowCorrel" 
                    Content="Show correlation" 
                    PointerEnter="PointerMoveFocus" />
    </UniformGrid>
    
    <WrapPanel Name="ParamsBlock" DockPanel.Dock="Bottom">
      
      <Expander Name="SignalParams" IsExpanded="True">
        <Expander.Header>
          <TextBlock Text="Signal parameters" />
        </Expander.Header>
        
        <UniformGrid Rows="2">
          <DockPanel>
            <TextBlock Text="Modulation type"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Bottom"
                       DockPanel.Dock="Top"
                       TextWrapping="Wrap"
                       Margin="8,10,8,2" />
            <ComboBox SelectedIndex="{Binding ModulationType, Mode=TwoWay}"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Stretch"
                    IsEnabled="{Binding EditMode}" 
                    PointerEnter="PointerMoveFocus">
              <ComboBoxItem Content="BASK (OOK)" />
              <ComboBoxItem Content="BPSK" />
              <ComboBoxItem Content="BFSK (FT)" />
            </ComboBox>
          </DockPanel>

          <local:NumberBox Header="Modulation depth"
                           Format="{}{0:F4}"
                           Step="0.01"
                           Value="{Binding ModulationDepth, Mode=TwoWay}"
                           PointerEnter="PointerMoveFocus" />
          
          <local:NumberBox Header="Modulation speed, bps"
                           Format="{}{0:F2}"
                           Step="10"
                           Value="{Binding ModulationSpeed, Mode=TwoWay}"
                           PointerEnter="PointerMoveFocus" />
          
          <local:NumberBox Header="Sequence length, bits"
                           Format="{}{0:F0}"
                           Step="1"
                           Value="{Binding BitSeqLength, Mode=TwoWay}" 
                           PointerEnter="PointerMoveFocus" />
          
          <local:NumberBox Header="Carrier frequency, Hz"
                           Format="{}{0:F2}"
                           Step="100"
                           Value="{Binding MainFrequency, Mode=TwoWay}" 
                           PointerEnter="PointerMoveFocus" />
          
          <local:NumberBox Header="Samplerate, Hz"
                           Format="{}{0:F0}"
                           Step="1000"
                           Value="{Binding Samplerate, Mode=TwoWay}" 
                           PointerEnter="PointerMoveFocus" />
        </UniformGrid>
      </Expander>
      
      <Expander Name="SimulationParams" IsExpanded="True">
        <Expander.Header>
          <TextBlock Text="Simulation param-s" />
        </Expander.Header>
        
        <UniformGrid Rows="2">
          <local:NumberBox Header="SNR for clean, dB"
                           Format="{}{0:F2}"
                           Step="1"
                           Value="{Binding SNRClean, Mode=TwoWay}" 
                           PointerEnter="PointerMoveFocus" />

          <local:NumberBox Header="SNR for noisy, dB"
                           Format="{}{0:F2}"
                           Step="1"
                           Value="{Binding SNRNoisy, Mode=TwoWay}" 
                           PointerEnter="PointerMoveFocus" />
          
          <local:NumberBox Header="Receive delay, s"
                           Format="{}{0:F4}"
                           Step="0.001"
                           Value="{Binding ReceiveDelay, Mode=TwoWay}" 
                           PointerEnter="PointerMoveFocus" />
          
          <local:NumberBox Header="Repeat tests count"
                           Format="{}{0:F0}"
                           Step="100"
                           Value="{Binding TestsRepeatCount, Mode=TwoWay}" 
                           PointerEnter="PointerMoveFocus" />
        </UniformGrid>
      </Expander>
    </WrapPanel>
    
    <Carousel Name="PlotsPanel" 
              Grid.Row="0" 
              SelectedIndex="{Binding #ToggleShowCorrel.IsChecked}">
      
      <UniformGrid Name="SignalPlots" Rows="2">
        <local:PlotView DataContext="{Binding Plots[0]}" />
        <local:PlotView DataContext="{Binding Plots[1]}" />
      </UniformGrid>
      
      <UniformGrid Name="CorrelPlots" Rows="2">
        <local:PlotView DataContext="{Binding Plots[2]}" />
        <local:PlotView DataContext="{Binding Plots[3]}" />
      </UniformGrid>
    </Carousel>
  </DockPanel>
</Window>
